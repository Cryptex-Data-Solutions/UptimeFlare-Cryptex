# UptimeFlare AWS - Example Terraform Variables
# Copy this file to terraform.tfvars and customize

project_name   = "uptimeflare"
central_region = "us-east-1"

# Regions where checker Lambdas will be deployed
checker_regions = [
  "us-east-1",
  "eu-west-1",
  "ap-southeast-1",
  "af-south-1"
]

# Monitor configuration (JSON string)
# Each monitor specifies which regions to check from and the primary region
monitors_config = <<EOF
[
  {
    "id": "example_api",
    "name": "Example API",
    "method": "GET",
    "target": "https://api.example.com/health",
    "expectedCodes": [200],
    "timeout": 10000,
    "regions": ["us-east-1", "eu-west-1", "ap-southeast-1"],
    "primaryRegion": "us-east-1",
    "latencyThreshold": 500,
    "alerting": {
      "downGracePeriod": 5,
      "slowGracePeriod": 3,
      "spikeDetection": {
        "enabled": true,
        "thresholdPercent": 200,
        "baselineWindowMinutes": 30
      }
    }
  },
  {
    "id": "za_service",
    "name": "South Africa Service",
    "method": "GET",
    "target": "https://za.example.com/api",
    "expectedCodes": [200],
    "timeout": 10000,
    "regions": ["af-south-1", "eu-west-1"],
    "primaryRegion": "af-south-1",
    "latencyThreshold": 300,
    "group": "Regional Services"
  },
  {
    "id": "ssh_server",
    "name": "SSH Server",
    "method": "TCP_PING",
    "target": "server.example.com:22",
    "timeout": 5000,
    "regions": ["us-east-1"],
    "primaryRegion": "us-east-1",
    "group": "Infrastructure"
  }
]
EOF

# Notification configuration (JSON string)
notification_config = <<EOF
{
  "webhook": {
    "url": "https://hooks.slack.com/services/YOUR/WEBHOOK/URL",
    "method": "POST",
    "payloadType": "json",
    "payload": {
      "text": "$MSG"
    },
    "timeout": 5000
  },
  "timeZone": "Africa/Johannesburg",
  "gracePeriod": 5,
  "skipNotificationIds": [],
  "skipErrorChangeNotification": false
}
EOF

# Page configuration (JSON string)
page_config = <<EOF
{
  "title": "My Status Page",
  "links": [
    {"link": "https://github.com/example", "label": "GitHub"},
    {"link": "mailto:support@example.com", "label": "Support", "highlight": true}
  ],
  "group": {
    "API Services": ["example_api"],
    "Regional Services": ["za_service"],
    "Infrastructure": ["ssh_server"]
  }
}
EOF

# Maintenance windows (JSON string)
maintenances_config = <<EOF
[
  {
    "monitors": ["example_api"],
    "title": "Scheduled Maintenance",
    "body": "Performing system updates",
    "start": "2025-06-01T02:00:00Z",
    "end": "2025-06-01T04:00:00Z",
    "color": "blue"
  }
]
EOF

# Optional: Basic auth protection (user:password)
# password_protection = "admin:secretpassword"

# Optional: Custom domain (requires ACM certificate)
# custom_domain   = "status.example.com"
# certificate_arn = "arn:aws:acm:us-east-1:123456789012:certificate/abc123"

# Lambda configuration
lambda_memory_size     = 256
lambda_timeout         = 30
check_interval_minutes = 1
log_retention_days     = 14

# DynamoDB billing mode
dynamodb_billing_mode = "PAY_PER_REQUEST"

# Tags
tags = {
  Project     = "UptimeFlare"
  Environment = "production"
  ManagedBy   = "Terraform"
}
